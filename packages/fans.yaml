automation:
  - alias: ðŸ†’ Toggle bed fan
    trigger:
      platform: event
      event_type: deconz_event
      event_data:
        id: bouton_lit
        event: 1003
    action:
      service: fan.toggle
      entity_id: fan.black_fan
  - alias: ðŸ†’ turn on office fan
    trigger:
      platform: event
      event_type: deconz_event
      event_data:
        id: tradfri_on_off_switch
        event: 1003
    action:
      service: fan.set_speed
      entity_id: fan.ventilateur_bureau
      data:
         speed: 'low'
  - alias: ðŸ†’ turn off office fan
    trigger:
      platform: event
      event_type: deconz_event
      event_data:
        id: tradfri_on_off_switch
        event: 2003
    action:
      service: fan.set_speed
      entity_id: fan.ventilateur_bureau
      data:
         speed: 'off'
  # auto switch off when it's cool enough
  - alias: ðŸ†’ turn office fan off
    trigger:
      - below: '25'
        entity_id: sensor.netatmo_mezon_bureau_temperature
        platform: numeric_state
    condition:
      - condition: state
        entity_id: fan.ventilateur_bureau
        state: 'on'
    action:
      - entity_id: fan.ventilateur_bureau
        service: fan.set_speed
        data:
          speed: 'off'
  - alias: ðŸ†’ Switch fans off if no one is home
    trigger:
      - platform: state
        entity_id: group.people
        from: 'home'
        to: 'not_home'
        for:
          minutes: 2
    action:
      - service: fan.turn_off
        entity_id:
          - fan.ventilateur_bureau
          - fan.xiaomi_smart_standing_fan
          - fan.black_fan

  - alias: ðŸ†’ Switch fans off at night time
    trigger:
      platform: state
      entity_id: input_boolean.night_time
      to: 'on'
    action:
      - service: fan.turn_off
        entity_id:
          - fan.ventilateur_bureau
          - fan.xiaomi_smart_standing_fan

fan:
  - platform: xiaomi_miio_fan
    name: Xiaomi Smart Standing fan
    host: 192.168.1.63
    token: 21f6d771728ebc67ce53a182df0f7a85
